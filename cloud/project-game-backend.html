<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>CloudFront 기반 정적 웹게임 자동 배포 서비스 구축 | 김태호 포트폴리오</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #0f172a;
      color: #e5e7eb;
      line-height: 1.6;
    }
    a { color: #38bdf8; text-decoration: none; }
    a:hover { text-decoration: underline; }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 1.5rem;
    }

    header {
      padding: 2rem 0 1rem;
      border-bottom: 1px solid #1f2937;
      margin-bottom: 2rem;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 1rem;
      color: #9ca3af;
      font-size: 0.9rem;
    }
    .back-link:hover {
      color: #38bdf8;
    }
    h1 {
      font-size: 2rem;
      margin: 0 0 0.5rem 0;
      color: #f9fafb;
    }
    .meta {
      font-size: 0.95rem;
      color: #9ca3af;
      margin-bottom: 1rem;
    }

    .content {
      margin: 2rem 0;
    }
    h2 {
      font-size: 1.5rem;
      margin: 2rem 0 1rem;
      color: #f9fafb;
      border-bottom: 1px solid #1f2937;
      padding-bottom: 0.5rem;
    }
    h3 {
      font-size: 1.2rem;
      margin: 1.5rem 0 0.75rem;
      color: #e5e7eb;
    }
    h4 {
      font-size: 1rem;
      margin: 1rem 0 0.5rem;
      color: #d1d5db;
    }
    p {
      margin: 1rem 0;
    }
    ul, ol {
      padding-left: 1.5rem;
      margin: 0.75rem 0;
    }
    li {
      margin-bottom: 0.5rem;
    }
    code {
      background: #1f2937;
      padding: 0.2rem 0.4rem;
      border-radius: 0.25rem;
      font-size: 0.9em;
      color: #60a5fa;
    }
    pre {
      background: #020617;
      border: 1px solid #1f2937;
      border-radius: 0.25rem;
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }
    pre code {
      background: transparent;
      padding: 0;
      color: #e5e7eb;
      font-size: 0.9em;
      line-height: 1.5;
    }
    .highlight-box {
      background: #020617;
      border-left: 3px solid #38bdf8;
      padding: 1rem 1.5rem;
      margin: 1.5rem 0;
      border-radius: 0.25rem;
    }
    iframe {
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .toggle-header {
      cursor: pointer;
      user-select: none;
      padding: 0.75rem 1rem;
      background: #1f2937;
      border: 1px solid #374151;
      border-radius: 0.25rem;
      margin: 1rem 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .toggle-header:hover {
      background: #374151;
    }
    .toggle-icon {
      transition: transform 0.3s ease;
      color: #9ca3af;
    }
    .toggle-header.collapsed .toggle-icon {
      transform: rotate(-90deg);
    }
    .toggle-content {
      display: none;
      margin-top: 0.5rem;
    }
    .toggle-content.expanded {
      display: block;
    }
    .tags {
      margin: 1.5rem 0;
    }
    .tag {
      display: inline-block;
      margin-right: 0.5rem;
      margin-bottom: 0.5rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      background: #111827;
      border: 1px solid #1f2937;
      color: #9ca3af;
      font-size: 0.85rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
    }
    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #1f2937;
    }
    th {
      background: #020617;
      color: #e5e7eb;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a href="../index.html" class="back-link">← 포트폴리오로 돌아가기</a>
      <h1>CloudFront 기반 정적 웹게임 자동 배포 서비스 구축</h1>
      <div class="meta">2025.11.10 ~ 2025.11.17 | 프라이빗 S3·CloudFront·GitHub Actions를 결합 웹 배포 시스템 구성</div>
    </header>

    <div class="content">
      <section>
        <h2>프로젝트 개요</h2>
        <p>
          HTML·CSS·JavaScript로 개발된 정적 웹 게임을
          AWS의 보안적이고 확장성 있는 구조(S3 + CloudFront) 위에서 호스팅하고,
          GitHub Actions를 활용해 코드 변경 시 자동 배포(CI/CD) 되도록 구성한 작업입니다.
        </p>
        <p>
          AWS 베스트 프랙티스를 기반으로 S3를 퍼블릭으로 열지 않고,
          CloudFront Origin Access Control(OAC)을 통해 Private S3를 안전하게 배포하는 형태로 구현했습니다.
        </p>
      </section>

      <section>
        <h2>실제 배포된 웹 게임</h2>
        <div style="margin: 2rem 0;">
          <div style="overflow: hidden; border: 1px solid #1f2937; border-radius: 0.5rem; padding: 1rem; background: #020617; text-align: center;">
            <iframe 
              src="https://d13d8rm0i0u05e.cloudfront.net" 
              style="width: 100%; height: 800px; border: none; border-radius: 0.25rem; background: #ffffff;"
              title="CloudFront 배포 웹 게임"
              allowfullscreen>
              <p>브라우저가 iframe을 지원하지 않습니다. <a href="https://d13d8rm0i0u05e.cloudfront.net" target="_blank">여기를 클릭하여 새 탭에서 열기</a></p>
            </iframe>
          </div>
          <p style="margin-top: 1rem; text-align: center;">
            <a href="https://d13d8rm0i0u05e.cloudfront.net" target="_blank" style="color: #38bdf8;">새 탭에서 열기</a>
          </p>
        </div>
      </section>

      <section>
        <h2>구축 목표</h2>
        <ul>
          <li>정적 웹게임을 AWS에서 안정적으로 호스팅</li>
          <li>S3 버킷을 Public으로 열지 않고 CloudFront를 통한 안전한 파일 제공</li>
          <li>GitHub Actions 기반 CI/CD 구축</li>
          <li>코드 수정 시 자동으로 S3 동기화 + CloudFront 캐시 무효화</li>
          <li>실무에서 사용하는 Origin Access Control(OAC), 버킷 정책 등 보안 설정 적용</li>
        </ul>
      </section>

      <section>
        <h2>사용 기술 스택</h2>
        <ul>
          <li><b>AWS S3</b> – Private 버킷에 정적 웹 리소스 저장</li>
          <li><b>AWS CloudFront</b> – CDN + HTTPS + OAC 보안</li>
          <li><b>AWS IAM</b> – GitHub Actions 권한 구성</li>
          <li><b>GitHub Repository + GitHub Actions</b> – CI/CD 자동 배포</li>
          <li><b>HTML / CSS / JavaScript</b> – 정적 게임 리소스</li>
        </ul>
      </section>

      <section>
        <h2>상세 구축 과정</h2>

        <h3>1. S3 버킷 생성 및 Private 설정</h3>
        <h4>생성된 버킷</h4>
        <ul>
          <li><code>taeho-project-webgame</code></li>
        </ul>
        <h4>적용된 보안 설정</h4>
        <ul>
          <li>퍼블릭 액세스 차단 4개 모두 ON</li>
          <li>Static website hosting 비활성화</li>
          <li>CloudFront 외에는 어떤 외부 요청도 S3 객체에 접근할 수 없도록 구성</li>
        </ul>

        <h3>2. CloudFront 배포 생성</h3>
        <p><b>설정 주요 포인트:</b></p>
        <ul>
          <li>Origin Type: Amazon S3</li>
          <li>S3 Origin: <code>taeho-project-webgame.s3.ap-northeast-2.amazonaws.com</code></li>
          <li>Origin Access Control (OAC): 새로 생성하여 적용</li>
          <li>Default Root Object: <code>index.html</code></li>
          <li>Security (WAF): 기본값 유지</li>
          <li>가격 클래스: 기본(전 Edge Location 사용)</li>
        </ul>
        <p><b>CloudFront 배포 도메인 예시:</b></p>
        <ul>
          <li><code>https://d13d8rm0i0u05e.cloudfront.net</code></li>
        </ul>

        <h3>3. 버킷 정책(OAC 기반) 적용</h3>
        <p>CloudFront가 S3의 객체를 읽기 위해 필요한 정책을 직접 작성하여 적용함.</p>
        <div class="toggle-header collapsed" onclick="toggleCodeBlock(this, 'bucket-policy')">
          <span>버킷 정책 보기</span>
          <span class="toggle-icon">▶</span>
        </div>
        <div id="bucket-policy" class="toggle-content">
          <pre><code>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowCloudFrontOriginAccess",
      "Effect": "Allow",
      "Principal": {
        "Service": "cloudfront.amazonaws.com"
      },
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::taeho-project-webgame/*",
      "Condition": {
        "StringEquals": {
          "AWS:SourceArn": "arn:aws:cloudfront::626614672806:distribution/EL8EKH83BRP96"
        }
      }
    }
  ]
}</code></pre>
        </div>
        <p>
          이 정책으로 인해 S3는 Public이 아니며, 오직 CloudFront를 통해서만 접근 가능합니다.
        </p>

        <h3>4. CloudFront 캐시 무효화(Invalidation) 테스트</h3>
        <ul>
          <li>콘솔에서 Invalidations 메뉴를 통해 <code>/*</code> 무효화 테스트 수행</li>
          <li>→ 캐시 삭제 후 즉시 최신 버전의 index.html 접속 가능</li>
        </ul>

        <h3>5. GitHub Actions CI/CD 구축</h3>
        <h4>GitHub Repository Secrets 설정</h4>
        <table>
          <tr>
            <th>Secret Name</th>
            <th>Value</th>
          </tr>
          <tr>
            <td>AWS_ACCESS_KEY_ID</td>
            <td>IAM Access Key</td>
          </tr>
          <tr>
            <td>AWS_SECRET_ACCESS_KEY</td>
            <td>IAM Secret</td>
          </tr>
          <tr>
            <td>AWS_REGION</td>
            <td>ap-northeast-2</td>
          </tr>
          <tr>
            <td>S3_BUCKET</td>
            <td>taeho-project-webgame</td>
          </tr>
          <tr>
            <td>CLOUDFRONT_DISTRIBUTION_ID</td>
            <td>EL8EKH83BRP96</td>
          </tr>
        </table>

        <h4>배포 자동화 Workflow 작성</h4>
        <div class="toggle-header collapsed" onclick="toggleCodeBlock(this, 'github-workflow')">
          <span>.github/workflows/deploy.yml 보기</span>
          <span class="toggle-icon">▶</span>
        </div>
        <div id="github-workflow" class="toggle-content">
          <pre><code>name: Deploy to S3 

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ${{ secrets.AWS_REGION }}

      - name: Sync files to S3
        run: |
          aws s3 sync . s3://${{ secrets.S3_BUCKET }} --delete \
            --exclude ".git/*" \
            --exclude ".github/*" \
            --exclude "*.md"

      - name: Invalidate CloudFront cache
        env:
          CF_DIST_ID: ${{ secrets.CLOUDFRONT_DISTRIBUTION_ID }}
        run: |
          aws cloudfront create-invalidation \
            --distribution-id "$CF_DIST_ID" \
            --paths "/*"</code></pre>
        </div>

        <h4>CI/CD 동작 방식</h4>
        <ol>
          <li>개발자가 GitHub Desktop에서 수정 후 push</li>
          <li>GitHub Actions가 자동 트리거</li>
          <li>변경된 파일을 S3 버킷에 동기화</li>
          <li>CloudFront 캐시 무효화 → 즉시 최신 버전 서비스 제공</li>
        </ol>
      </section>

      <section>
        <h2>테스트 결과</h2>
        <ul>
          <li>CloudFront 도메인을 통해 웹게임 정상적으로 제공</li>
          <li>S3 단독 접근 시 AccessDenied 발생 → Private S3 보안 정상 작동</li>
          <li>코드 수정 후 push 시 자동 배포 및 즉시 반영 성공</li>
        </ul>
      </section>

      <section>
        <h2>성과 및 학습 포인트</h2>
        <ul>
          <li>AWS 베스트 프랙티스 기반의 Private S3 + CloudFront OAC 구조 구현</li>
          <li>GitHub Actions를 이용한 완전 자동화 배포 파이프라인 구축</li>
          <li>CloudFront Invalidation 자동화로 운영 효율성 개선</li>
          <li>실무에서 사용하는 CDN 기반 정적 웹서비스 구성 경험 확보</li>
        </ul>
      </section>

      <section>
        <h2>최종 서비스 구조</h2>
        <div class="highlight-box">
          <p style="text-align: center; margin: 0; font-size: 1.1rem;">
            <b>GitHub → GitHub Actions → S3 (Private) ↔ CloudFront(OAC) → User</b>
          </p>
        </div>
        <p style="text-align: center; color: #9ca3af; margin-top: 1rem;">
          완전히 안전하며, 빠르고, 자동화된 정적 웹 애플리케이션 배포 구조입니다.
        </p>
      </section>
    </div>
  </div>

  <script>
    function toggleCodeBlock(header, contentId) {
      const content = document.getElementById(contentId);
      const isExpanded = content.classList.contains('expanded');
      
      if (isExpanded) {
        content.classList.remove('expanded');
        header.classList.add('collapsed');
      } else {
        content.classList.add('expanded');
        header.classList.remove('collapsed');
      }
    }
  </script>
</body>
</html>

